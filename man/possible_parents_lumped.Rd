% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{possible_parents_lumped}
\alias{possible_parents_lumped}
\title{Compute Lumped Parental Allele States}
\usage{
possible_parents_lumped(child, states, states_matrix, T_prob)
}
\arguments{
\item{child}{A numeric or integer vector of length \eqn{S} representing the
lumped state of the child across \eqn{S} sites. Each element typically encodes
mutation class at that site.}

\item{states}{A named list mapping string representations of lumped states to
integer indices in \code{states_matrix}.}

\item{states_matrix}{A matrix of dimension \eqn{K \times S} where each row
corresponds to a valid lumped allele configuration.}

\item{T_prob}{A matrix of dimension \eqn{K \times K} giving the transition
probabilities between lumped states, where entry \code{T_prob[i, j]} encodes
\eqn{P(\text{child state } j \mid \text{parent state } i)}.}
}
\value{
A matrix of dimension \eqn{L \times S}, where each of the \eqn{L} rows is a
lumped parental allele state that can give rise to the specified child state
with non-zero probability.
}
\description{
Given the lumped allele state of a child, this function returns all valid lumped
parental allele states with non-zero transition probability under a specified
mutation model. This is a preliminary step used by both exact and approximate
parental expansion functions to efficiently prune impossible transitions.
}
\details{
The \emph{lumped} allele model groups allele states by mutation class (or
mutational load), reducing the full mutation model to a smaller state space.
A parental state is included if the corresponding entry in the transition
probability matrix \code{T_prob} (representing \eqn{P(child | parent}) is
strictly positive.

The ancestral (zero-mutation) state is automatically included as a fallback,
even if not explicitly allowed by \code{T_prob}. This ensures numerical
stability in downstream expansion of masked or overlapping allele states.
}
