% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{all_allele_states}
\alias{all_allele_states}
\title{Enumerate All Possible Allele States for a Given Mutation State}
\usage{
all_allele_states(m_state, M)
}
\arguments{
\item{m_state}{An integer vector of length \eqn{S} representing the mutation
state of an allele across \eqn{S} genomic sites.}

\item{M}{An integer matrix of dimension \eqn{S \times S}, specifying the number
of allowable allele states per site or per overlap segment (as described above).}
}
\value{
A matrix of dimension \eqn{K \times S}, where \eqn{K} is the total number of
valid allele configurations corresponding to the input mutation state. Each row
is one possible allele state.
#For the mutation state, returns all possible
}
\description{
Computes all possible allele configurations corresponding to a given mutation state
under the finite-alleles mutation model. Allele states are expanded recursively
based on the number of allowable alleles per site or overlapping region as specified
by the matrix \code{M}.
}
\details{
The mutation state vector \code{m_state} encodes the mutation status at each of
\eqn{S} sites:
\itemize{
  \item \code{0}: no mutation at that site
  \item \code{1}: a single-site mutation (derived allele)
  \item \code{>1}: marker for a multi-site overlapping mutation involving a
    block of adjacent sites (from site \eqn{s} to \eqn{e} where \code{m_state[s] == m_state[e]}).
}

For each segment or block, the number of distinct allowable alleles is determined
by the matrix \code{M}, where:
\itemize{
  \item \code{M[i, i]} gives the number of alleles with mutation at site \eqn{i},
  \item \code{M[i, j]} (for \eqn{i < j}) gives the number of alleles for a mutation
    block spanning sites \eqn{i} to \eqn{j}.
}

Expansion is handled recursively site by site, and the resulting allele configurations
are returned as a matrix, one per row.
}
