% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{possible_parents_approximate}
\alias{possible_parents_approximate}
\title{Compute Approximate Parental Allele States Using Leaf Alleles}
\usage{
possible_parents_approximate(child, states, states_matrix, T_prob, leaves)
}
\arguments{
\item{child}{A character vector of length \eqn{S} representing the observed
allele states of the child node across \eqn{S} sites.}

\item{states}{A named list of valid lumped allele states, indexed by string
encodings.}

\item{states_matrix}{A matrix encoding valid combinations of lumped allele
states, for efficient lookup and indexing during recombination.}

\item{T_prob}{A precomputed list or structure of transition probabilities,
governing lumped allele transitions.}

\item{leaves}{A matrix where each row is a valid allele configuration
observed in the tree leaves (tip nodes). These are used to restrict masked
overlaps.}
}
\value{
A list of character vectors, each of length \eqn{S}, corresponding to possible
parental allele configurations for the given child under the approximate scheme.
}
\description{
Computes all valid parental allele configurations for a given child allele
under an approximate finite-alleles mutation model. Unlike the exact version
implemented in \code{\link{possible_parents_FA}}, this function restricts
overlap-resolving mutations to only those alleles that appear in the observed
leaf data (plus one wildcard for unseen alleles).
}
\details{
The function enumerates possible parent allele states for the child based on
the lumped allele transition model and partial masking from overlapping
mutations. For overlapping sites, rather than generating all possible
mutations from the mutation count matrix \code{M}, this approximate approach
limits possible alleles at each masked site to those observed in the leaf
set (plus a single wildcard to model any unseen allele).

This can drastically reduce the number of possible masked configurations,
making computation practical for large trees, while still preserving the major
allele patterns.
}
