% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulation.R
\name{haplotypes}
\alias{haplotypes}
\title{Initialize Haplotypes and Leaf Probabilities for Finite Alleles Model}
\usage{
haplotypes(D, n, S)
}
\arguments{
\item{D}{A character or numeric matrix of dimension \eqn{n \times S} containing
the observed alleles (haplotypes) for each of \eqn{n} leaves across \eqn{S} sites.
Each row corresponds to one haplotype.}

\item{n}{Integer. The number of haplotypes (number of rows in \code{D}).}

\item{S}{Integer. The number of sites (number of columns in \code{D}).}
}
\value{
A list with the following components:
\describe{
  \item{\code{alleles}}{A matrix of unique observed alleles, one per row.}
  \item{\code{p}}{An \eqn{A \times (2n - 1)} matrix of initialized forward probabilities.}
}
}
\description{
Constructs a summary of the observed haplotypes in the data and initializes the
corresponding forward probability matrix (\eqn{p}) for use in the \code{pq_vectors()}
function. Each unique haplotype is treated as a distinct allele and is assigned
a row in both the allele matrix and the \eqn{p}-matrix.
}
\details{
The function initializes two objects:
\describe{
  \item{\code{alleles}}{A matrix of dimension \eqn{A \times S}, where each
  row corresponds to one of the \eqn{A} unique alleles observed in the data,
  and each column corresponds to a genetic site (of length \eqn{S}).}
  \item{\code{p}}{A matrix of dimension \eqn{A \times (2n - 1)} containing the
  initial forward probabilities for each allele at each tree node. The first \eqn{n}
  columns correspond to the observed leaf nodes and are initialized as
  indicator vectors for the observed alleles.}
}
}
